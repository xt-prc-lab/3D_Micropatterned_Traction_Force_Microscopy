%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%                                                                                                                              %
%                            Coefficients of the derivatives of the shape functions for the element.                           %
%                                                                                                                              %
%   Inputs:                                                                                                                    %
%       x1, x2, x3, x4, y1, y2, y3, y4, z1, z2, z3, z4 [float]; x, y and z coordinates of the four nodes of the element.       %
%                                                                                                                              %
%   Outputs:                                                                                                                   %
%       C11, C12, C13, C14, C21, C22, C23, C24, C31, C32, C33, C34, C41, C42, C43, C44 [float]: Coefficients of the            %
%                                                                   derivatives of the shape functions for the element.        %
%                                                                                                                              %
%   Last Revison Date: 23/01/2024                                                                                              %
%   Author: Manuel Gomez Gonzalez                                                                                              %
%                                                                                                                              %
%   References:                                                                                                                %
%       N/A.                                                                                                                   %
%                                                                                                                              %
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

function [C11, C12, C13, C14, C21, C22, C23, C24, C31, C32, C33, C34, C41, C42, C43, C44] = ...
                                                    coeffs_penalization_function(x1, x2, x3, x4, y1, y2, y3, y4, z1, z2, z3, z4)

    C_denom = -(x1*y2*z3 - x1*y2*z4 - x1*y3*z2 + x1*y3*z4 + x1*y4*z2 - x1*y4*z3 - x2*y1*z3 + x2*y1*z4 + x2*y3*z1 - ...
                x2*y3*z4 - x2*y4*z1 + x2*y4*z3 + x3*y1*z2 - x3*y1*z4 - x3*y2*z1 + x3*y2*z4 + x3*y4*z1 - x3*y4*z2 - ...
                x4*y1*z2 + x4*y1*z3 + x4*y2*z1 - x4*y2*z3 - x4*y3*z1 + x4*y3*z2)^2;

    C11_num = -x2^2*y3^2 + 2*x2^2*y3*y4 - x2^2*y4^2 - x2^2*z3^2 + 2*x2^2*z3*z4 - x2^2*z4^2 + 2*x2*x3*y2*y3 - 2*x2*x3*y2*y4 - ...
               2*x2*x3*y3*y4 + 2*x2*x3*y4^2 + 2*x2*x3*z2*z3 - 2*x2*x3*z2*z4 - 2*x2*x3*z3*z4 + 2*x2*x3*z4^2 - 2*x2*x4*y2*y3 + ...
               2*x2*x4*y2*y4 + 2*x2*x4*y3^2 - 2*x2*x4*y3*y4 - 2*x2*x4*z2*z3 + 2*x2*x4*z2*z4 + 2*x2*x4*z3^2 - 2*x2*x4*z3*z4 - ...
               x3^2*y2^2 + 2*x3^2*y2*y4 - x3^2*y4^2 - x3^2*z2^2 + 2*x3^2*z2*z4 - x3^2*z4^2 + 2*x3*x4*y2^2 - 2*x3*x4*y2*y3 - ...
               2*x3*x4*y2*y4 + 2*x3*x4*y3*y4 + 2*x3*x4*z2^2 - 2*x3*x4*z2*z3 - 2*x3*x4*z2*z4 + 2*x3*x4*z3*z4 - x4^2*y2^2 + ...
               2*x4^2*y2*y3 - x4^2*y3^2 - x4^2*z2^2 + 2*x4^2*z2*z3 - x4^2*z3^2 - y2^2*z3^2 + 2*y2^2*z3*z4 - y2^2*z4^2 + ...
               2*y2*y3*z2*z3 - 2*y2*y3*z2*z4 - 2*y2*y3*z3*z4 + 2*y2*y3*z4^2 - 2*y2*y4*z2*z3 + 2*y2*y4*z2*z4 + 2*y2*y4*z3^2 - ...
               2*y2*y4*z3*z4 - y3^2*z2^2 + 2*y3^2*z2*z4 - y3^2*z4^2 + 2*y3*y4*z2^2 - 2*y3*y4*z2*z3 - 2*y3*y4*z2*z4 + ...
               2*y3*y4*z3*z4 - y4^2*z2^2 + 2*y4^2*z2*z3 - y4^2*z3^2;

    C12_num = x1*x2*y3^2 - 2*x1*x2*y3*y4 + x1*x2*y4^2 + x1*x2*z3^2 - 2*x1*x2*z3*z4 + x1*x2*z4^2 - x1*x3*y2*y3 + ...
              x1*x3*y2*y4 + x1*x3*y3*y4 - x1*x3*y4^2 - x1*x3*z2*z3 + x1*x3*z2*z4 + x1*x3*z3*z4 - x1*x3*z4^2 + x1*x4*y2*y3 - ...
              x1*x4*y2*y4 - x1*x4*y3^2 + x1*x4*y3*y4 + x1*x4*z2*z3 - x1*x4*z2*z4 - x1*x4*z3^2 + x1*x4*z3*z4 - x2*x3*y1*y3 + ...
              x2*x3*y1*y4 + x2*x3*y3*y4 - x2*x3*y4^2 - x2*x3*z1*z3 + x2*x3*z1*z4 + x2*x3*z3*z4 - x2*x3*z4^2 + x2*x4*y1*y3 - ...
              x2*x4*y1*y4 - x2*x4*y3^2 + x2*x4*y3*y4 + x2*x4*z1*z3 - x2*x4*z1*z4 - x2*x4*z3^2 + x2*x4*z3*z4 + x3^2*y1*y2 - ...
              x3^2*y1*y4 - x3^2*y2*y4 + x3^2*y4^2 + x3^2*z1*z2 - x3^2*z1*z4 - x3^2*z2*z4 + x3^2*z4^2 - 2*x3*x4*y1*y2 + ...
              x3*x4*y1*y3 + x3*x4*y1*y4 + x3*x4*y2*y3 + x3*x4*y2*y4 - 2*x3*x4*y3*y4 - 2*x3*x4*z1*z2 + x3*x4*z1*z3 + ...
              x3*x4*z1*z4 + x3*x4*z2*z3 + x3*x4*z2*z4 - 2*x3*x4*z3*z4 + x4^2*y1*y2 - x4^2*y1*y3 - x4^2*y2*y3 + x4^2*y3^2 + ...
              x4^2*z1*z2 - x4^2*z1*z3 - x4^2*z2*z3 + x4^2*z3^2 + y1*y2*z3^2 - 2*y1*y2*z3*z4 + y1*y2*z4^2 - y1*y3*z2*z3 + ...
              y1*y3*z2*z4 + y1*y3*z3*z4 - y1*y3*z4^2 + y1*y4*z2*z3 - y1*y4*z2*z4 - y1*y4*z3^2 + y1*y4*z3*z4 - y2*y3*z1*z3 + ...
              y2*y3*z1*z4 + y2*y3*z3*z4 - y2*y3*z4^2 + y2*y4*z1*z3 - y2*y4*z1*z4 - y2*y4*z3^2 + y2*y4*z3*z4 + y3^2*z1*z2 - ...
              y3^2*z1*z4 - y3^2*z2*z4 + y3^2*z4^2 - 2*y3*y4*z1*z2 + y3*y4*z1*z3 + y3*y4*z1*z4 + y3*y4*z2*z3 + y3*y4*z2*z4 - ...
              2*y3*y4*z3*z4 + y4^2*z1*z2 - y4^2*z1*z3 - y4^2*z2*z3 + y4^2*z3^2;

    C13_num = -x1*x2*y2*y3 + x1*x2*y2*y4 + x1*x2*y3*y4 - x1*x2*y4^2 - x1*x2*z2*z3 + x1*x2*z2*z4 + x1*x2*z3*z4 - x1*x2*z4^2 + ...
               x1*x3*y2^2 - 2*x1*x3*y2*y4 + x1*x3*y4^2 + x1*x3*z2^2 - 2*x1*x3*z2*z4 + x1*x3*z4^2 - x1*x4*y2^2 + ...
               x1*x4*y2*y3 + x1*x4*y2*y4 - x1*x4*y3*y4 - x1*x4*z2^2 + x1*x4*z2*z3 + x1*x4*z2*z4 - x1*x4*z3*z4 + x2^2*y1*y3 - ...
               x2^2*y1*y4 - x2^2*y3*y4 + x2^2*y4^2 + x2^2*z1*z3 - x2^2*z1*z4 - x2^2*z3*z4 + x2^2*z4^2 - x2*x3*y1*y2 + ...
               x2*x3*y1*y4 + x2*x3*y2*y4 - x2*x3*y4^2 - x2*x3*z1*z2 + x2*x3*z1*z4 + x2*x3*z2*z4 - x2*x3*z4^2 + x2*x4*y1*y2 - ...
               2*x2*x4*y1*y3 + x2*x4*y1*y4 + x2*x4*y2*y3 - 2*x2*x4*y2*y4 + x2*x4*y3*y4 + x2*x4*z1*z2 - 2*x2*x4*z1*z3 + ...
               x2*x4*z1*z4 + x2*x4*z2*z3 - 2*x2*x4*z2*z4 + x2*x4*z3*z4 + x3*x4*y1*y2 - x3*x4*y1*y4 - x3*x4*y2^2 + ...
               x3*x4*y2*y4 + x3*x4*z1*z2 - x3*x4*z1*z4 - x3*x4*z2^2 + x3*x4*z2*z4 - x4^2*y1*y2 + x4^2*y1*y3 + x4^2*y2^2 - ...
               x4^2*y2*y3 - x4^2*z1*z2 + x4^2*z1*z3 + x4^2*z2^2 - x4^2*z2*z3 - y1*y2*z2*z3 + y1*y2*z2*z4 + y1*y2*z3*z4 - ...
               y1*y2*z4^2 + y1*y3*z2^2 - 2*y1*y3*z2*z4 + y1*y3*z4^2 - y1*y4*z2^2 + y1*y4*z2*z3 + y1*y4*z2*z4 - y1*y4*z3*z4 + ...
               y2^2*z1*z3 - y2^2*z1*z4 - y2^2*z3*z4 + y2^2*z4^2 - y2*y3*z1*z2 + y2*y3*z1*z4 + y2*y3*z2*z4 - y2*y3*z4^2 + ...
               y2*y4*z1*z2 - 2*y2*y4*z1*z3 + y2*y4*z1*z4 + y2*y4*z2*z3 - 2*y2*y4*z2*z4 + y2*y4*z3*z4 + y3*y4*z1*z2 - ...
               y3*y4*z1*z4 - y3*y4*z2^2 + y3*y4*z2*z4 - y4^2*z1*z2 + y4^2*z1*z3 + y4^2*z2^2 - y4^2*z2*z3;

    C14_num = x1*x2*y2*y3 - x1*x2*y2*y4 - x1*x2*y3^2 + x1*x2*y3*y4 + x1*x2*z2*z3 - x1*x2*z2*z4 - x1*x2*z3^2 + x1*x2*z3*z4 - ...
              x1*x3*y2^2 + x1*x3*y2*y3 + x1*x3*y2*y4 - x1*x3*y3*y4 - x1*x3*z2^2 + x1*x3*z2*z3 + x1*x3*z2*z4 - x1*x3*z3*z4 + ...
              x1*x4*y2^2 - 2*x1*x4*y2*y3 + x1*x4*y3^2 + x1*x4*z2^2 - 2*x1*x4*z2*z3 + x1*x4*z3^2 - x2^2*y1*y3 + x2^2*y1*y4 + ...
              x2^2*y3^2 - x2^2*y3*y4 - x2^2*z1*z3 + x2^2*z1*z4 + x2^2*z3^2 - x2^2*z3*z4 + x2*x3*y1*y2 + x2*x3*y1*y3 - ...
              2*x2*x3*y1*y4 - 2*x2*x3*y2*y3 + x2*x3*y2*y4 + x2*x3*y3*y4 + x2*x3*z1*z2 + x2*x3*z1*z3 - 2*x2*x3*z1*z4 - ...
              2*x2*x3*z2*z3 + x2*x3*z2*z4 + x2*x3*z3*z4 - x2*x4*y1*y2 + x2*x4*y1*y3 + x2*x4*y2*y3 - x2*x4*y3^2 - ...
              x2*x4*z1*z2 + x2*x4*z1*z3 + x2*x4*z2*z3 - x2*x4*z3^2 - x3^2*y1*y2 + x3^2*y1*y4 + x3^2*y2^2 - x3^2*y2*y4 - ...
              x3^2*z1*z2 + x3^2*z1*z4 + x3^2*z2^2 - x3^2*z2*z4 + x3*x4*y1*y2 - x3*x4*y1*y3 - x3*x4*y2^2 + x3*x4*y2*y3 + ...
              x3*x4*z1*z2 - x3*x4*z1*z3 - x3*x4*z2^2 + x3*x4*z2*z3 + y1*y2*z2*z3 - y1*y2*z2*z4 - y1*y2*z3^2 + y1*y2*z3*z4 - ...
              y1*y3*z2^2 + y1*y3*z2*z3 + y1*y3*z2*z4 - y1*y3*z3*z4 + y1*y4*z2^2 - 2*y1*y4*z2*z3 + y1*y4*z3^2 - y2^2*z1*z3 + ...
              y2^2*z1*z4 + y2^2*z3^2 - y2^2*z3*z4 + y2*y3*z1*z2 + y2*y3*z1*z3 - 2*y2*y3*z1*z4 - 2*y2*y3*z2*z3 + ...
              y2*y3*z2*z4 + y2*y3*z3*z4 - y2*y4*z1*z2 + y2*y4*z1*z3 + y2*y4*z2*z3 - y2*y4*z3^2 - y3^2*z1*z2 + y3^2*z1*z4 + ...
              y3^2*z2^2 - y3^2*z2*z4 + y3*y4*z1*z2 - y3*y4*z1*z3 - y3*y4*z2^2 + y3*y4*z2*z3;

    C22_num = -x1^2*y3^2 + 2*x1^2*y3*y4 - x1^2*y4^2 - x1^2*z3^2 + 2*x1^2*z3*z4 - x1^2*z4^2 + 2*x1*x3*y1*y3 - 2*x1*x3*y1*y4 - ...
               2*x1*x3*y3*y4 + 2*x1*x3*y4^2 + 2*x1*x3*z1*z3 - 2*x1*x3*z1*z4 - 2*x1*x3*z3*z4 + 2*x1*x3*z4^2 - 2*x1*x4*y1*y3 + ...
               2*x1*x4*y1*y4 + 2*x1*x4*y3^2 - 2*x1*x4*y3*y4 - 2*x1*x4*z1*z3 + 2*x1*x4*z1*z4 + 2*x1*x4*z3^2 - 2*x1*x4*z3*z4 - ...
               x3^2*y1^2 + 2*x3^2*y1*y4 - x3^2*y4^2 - x3^2*z1^2 + 2*x3^2*z1*z4 - x3^2*z4^2 + 2*x3*x4*y1^2 - 2*x3*x4*y1*y3 - ...
               2*x3*x4*y1*y4 + 2*x3*x4*y3*y4 + 2*x3*x4*z1^2 - 2*x3*x4*z1*z3 - 2*x3*x4*z1*z4 + 2*x3*x4*z3*z4 - x4^2*y1^2 + ...
               2*x4^2*y1*y3 - x4^2*y3^2 - x4^2*z1^2 + 2*x4^2*z1*z3 - x4^2*z3^2 - y1^2*z3^2 + 2*y1^2*z3*z4 - y1^2*z4^2 + ...
               2*y1*y3*z1*z3 - 2*y1*y3*z1*z4 - 2*y1*y3*z3*z4 + 2*y1*y3*z4^2 - 2*y1*y4*z1*z3 + 2*y1*y4*z1*z4 + 2*y1*y4*z3^2 - ...
               2*y1*y4*z3*z4 - y3^2*z1^2 + 2*y3^2*z1*z4 - y3^2*z4^2 + 2*y3*y4*z1^2 - 2*y3*y4*z1*z3 - 2*y3*y4*z1*z4 + ...
               2*y3*y4*z3*z4 - y4^2*z1^2 + 2*y4^2*z1*z3 - y4^2*z3^2;

    C23_num = x1^2*y2*y3 - x1^2*y2*y4 - x1^2*y3*y4 + x1^2*y4^2 + x1^2*z2*z3 - x1^2*z2*z4 - x1^2*z3*z4 + x1^2*z4^2 - ...
              x1*x2*y1*y3 + x1*x2*y1*y4 + x1*x2*y3*y4 - x1*x2*y4^2 - x1*x2*z1*z3 + x1*x2*z1*z4 + x1*x2*z3*z4 - x1*x2*z4^2 - ...
              x1*x3*y1*y2 + x1*x3*y1*y4 + x1*x3*y2*y4 - x1*x3*y4^2 - x1*x3*z1*z2 + x1*x3*z1*z4 + x1*x3*z2*z4 - x1*x3*z4^2 + ...
              x1*x4*y1*y2 + x1*x4*y1*y3 - 2*x1*x4*y1*y4 - 2*x1*x4*y2*y3 + x1*x4*y2*y4 + x1*x4*y3*y4 + x1*x4*z1*z2 + ...
              x1*x4*z1*z3 - 2*x1*x4*z1*z4 - 2*x1*x4*z2*z3 + x1*x4*z2*z4 + x1*x4*z3*z4 + x2*x3*y1^2 - 2*x2*x3*y1*y4 + ...
              x2*x3*y4^2 + x2*x3*z1^2 - 2*x2*x3*z1*z4 + x2*x3*z4^2 - x2*x4*y1^2 + x2*x4*y1*y3 + x2*x4*y1*y4 - x2*x4*y3*y4 - ...
              x2*x4*z1^2 + x2*x4*z1*z3 + x2*x4*z1*z4 - x2*x4*z3*z4 - x3*x4*y1^2 + x3*x4*y1*y2 + x3*x4*y1*y4 - x3*x4*y2*y4 - ...
              x3*x4*z1^2 + x3*x4*z1*z2 + x3*x4*z1*z4 - x3*x4*z2*z4 + x4^2*y1^2 - x4^2*y1*y2 - x4^2*y1*y3 + x4^2*y2*y3 + ...
              x4^2*z1^2 - x4^2*z1*z2 - x4^2*z1*z3 + x4^2*z2*z3 + y1^2*z2*z3 - y1^2*z2*z4 - y1^2*z3*z4 + y1^2*z4^2 - ...
              y1*y2*z1*z3 + y1*y2*z1*z4 + y1*y2*z3*z4 - y1*y2*z4^2 - y1*y3*z1*z2 + y1*y3*z1*z4 + y1*y3*z2*z4 - y1*y3*z4^2 + ...
              y1*y4*z1*z2 + y1*y4*z1*z3 - 2*y1*y4*z1*z4 - 2*y1*y4*z2*z3 + y1*y4*z2*z4 + y1*y4*z3*z4 + y2*y3*z1^2 - ...
              2*y2*y3*z1*z4 + y2*y3*z4^2 - y2*y4*z1^2 + y2*y4*z1*z3 + y2*y4*z1*z4 - y2*y4*z3*z4 - y3*y4*z1^2 + y3*y4*z1*z2 + ...
              y3*y4*z1*z4 - y3*y4*z2*z4 + y4^2*z1^2 - y4^2*z1*z2 - y4^2*z1*z3 + y4^2*z2*z3;

    C24_num = -x1^2*y2*y3 + x1^2*y2*y4 + x1^2*y3^2 - x1^2*y3*y4 - x1^2*z2*z3 + x1^2*z2*z4 + x1^2*z3^2 - x1^2*z3*z4 + ...
               x1*x2*y1*y3 - x1*x2*y1*y4 - x1*x2*y3^2 + x1*x2*y3*y4 + x1*x2*z1*z3 - x1*x2*z1*z4 - x1*x2*z3^2 + x1*x2*z3*z4 + ...
               x1*x3*y1*y2 - 2*x1*x3*y1*y3 + x1*x3*y1*y4 + x1*x3*y2*y3 - 2*x1*x3*y2*y4 + x1*x3*y3*y4 + x1*x3*z1*z2 - ...
               2*x1*x3*z1*z3 + x1*x3*z1*z4 + x1*x3*z2*z3 - 2*x1*x3*z2*z4 + x1*x3*z3*z4 - x1*x4*y1*y2 + x1*x4*y1*y3 + ...
               x1*x4*y2*y3 - x1*x4*y3^2 - x1*x4*z1*z2 + x1*x4*z1*z3 + x1*x4*z2*z3 - x1*x4*z3^2 - x2*x3*y1^2 + x2*x3*y1*y3 + ...
               x2*x3*y1*y4 - x2*x3*y3*y4 - x2*x3*z1^2 + x2*x3*z1*z3 + x2*x3*z1*z4 - x2*x3*z3*z4 + x2*x4*y1^2 - ...
               2*x2*x4*y1*y3 + x2*x4*y3^2 + x2*x4*z1^2 - 2*x2*x4*z1*z3 + x2*x4*z3^2 + x3^2*y1^2 - x3^2*y1*y2 - x3^2*y1*y4 + ...
               x3^2*y2*y4 + x3^2*z1^2 - x3^2*z1*z2 - x3^2*z1*z4 + x3^2*z2*z4 - x3*x4*y1^2 + x3*x4*y1*y2 + x3*x4*y1*y3 - ...
               x3*x4*y2*y3 - x3*x4*z1^2 + x3*x4*z1*z2 + x3*x4*z1*z3 - x3*x4*z2*z3 - y1^2*z2*z3 + y1^2*z2*z4 + y1^2*z3^2 - ...
               y1^2*z3*z4 + y1*y2*z1*z3 - y1*y2*z1*z4 - y1*y2*z3^2 + y1*y2*z3*z4 + y1*y3*z1*z2 - 2*y1*y3*z1*z3 + ...
               y1*y3*z1*z4 + y1*y3*z2*z3 - 2*y1*y3*z2*z4 + y1*y3*z3*z4 - y1*y4*z1*z2 + y1*y4*z1*z3 + y1*y4*z2*z3 - ...
               y1*y4*z3^2 - y2*y3*z1^2 + y2*y3*z1*z3 + y2*y3*z1*z4 - y2*y3*z3*z4 + y2*y4*z1^2 - 2*y2*y4*z1*z3 + y2*y4*z3^2 + ...
               y3^2*z1^2 - y3^2*z1*z2 - y3^2*z1*z4 + y3^2*z2*z4 - y3*y4*z1^2 + y3*y4*z1*z2 + y3*y4*z1*z3 - y3*y4*z2*z3;

    C33_num = -x1^2*y2^2 + 2*x1^2*y2*y4 - x1^2*y4^2 - x1^2*z2^2 + 2*x1^2*z2*z4 - x1^2*z4^2 + 2*x1*x2*y1*y2 - 2*x1*x2*y1*y4 - ...
               2*x1*x2*y2*y4 + 2*x1*x2*y4^2 + 2*x1*x2*z1*z2 - 2*x1*x2*z1*z4 - 2*x1*x2*z2*z4 + 2*x1*x2*z4^2 - 2*x1*x4*y1*y2 + ...
               2*x1*x4*y1*y4 + 2*x1*x4*y2^2 - 2*x1*x4*y2*y4 - 2*x1*x4*z1*z2 + 2*x1*x4*z1*z4 + 2*x1*x4*z2^2 - 2*x1*x4*z2*z4 - ...
               x2^2*y1^2 + 2*x2^2*y1*y4 - x2^2*y4^2 - x2^2*z1^2 + 2*x2^2*z1*z4 - x2^2*z4^2 + 2*x2*x4*y1^2 - 2*x2*x4*y1*y2 - ...
               2*x2*x4*y1*y4 + 2*x2*x4*y2*y4 + 2*x2*x4*z1^2 - 2*x2*x4*z1*z2 - 2*x2*x4*z1*z4 + 2*x2*x4*z2*z4 - x4^2*y1^2 + ...
               2*x4^2*y1*y2 - x4^2*y2^2 - x4^2*z1^2 + 2*x4^2*z1*z2 - x4^2*z2^2 - y1^2*z2^2 + 2*y1^2*z2*z4 - y1^2*z4^2 + ...
               2*y1*y2*z1*z2 - 2*y1*y2*z1*z4 - 2*y1*y2*z2*z4 + 2*y1*y2*z4^2 - 2*y1*y4*z1*z2 + 2*y1*y4*z1*z4 + 2*y1*y4*z2^2 - ...
               2*y1*y4*z2*z4 - y2^2*z1^2 + 2*y2^2*z1*z4 - y2^2*z4^2 + 2*y2*y4*z1^2 - 2*y2*y4*z1*z2 - 2*y2*y4*z1*z4 + ...
               2*y2*y4*z2*z4 - y4^2*z1^2 + 2*y4^2*z1*z2 - y4^2*z2^2;

    C34_num = x1^2*y2^2 - x1^2*y2*y3 - x1^2*y2*y4 + x1^2*y3*y4 + x1^2*z2^2 - x1^2*z2*z3 - x1^2*z2*z4 + x1^2*z3*z4 - ...
              2*x1*x2*y1*y2 + x1*x2*y1*y3 + x1*x2*y1*y4 + x1*x2*y2*y3 + x1*x2*y2*y4 - 2*x1*x2*y3*y4 - 2*x1*x2*z1*z2 + ...
              x1*x2*z1*z3 + x1*x2*z1*z4 + x1*x2*z2*z3 + x1*x2*z2*z4 - 2*x1*x2*z3*z4 + x1*x3*y1*y2 - x1*x3*y1*y4 - ...
              x1*x3*y2^2 + x1*x3*y2*y4 + x1*x3*z1*z2 - x1*x3*z1*z4 - x1*x3*z2^2 + x1*x3*z2*z4 + x1*x4*y1*y2 - x1*x4*y1*y3 - ...
              x1*x4*y2^2 + x1*x4*y2*y3 + x1*x4*z1*z2 - x1*x4*z1*z3 - x1*x4*z2^2 + x1*x4*z2*z3 + x2^2*y1^2 - x2^2*y1*y3 - ...
              x2^2*y1*y4 + x2^2*y3*y4 + x2^2*z1^2 - x2^2*z1*z3 - x2^2*z1*z4 + x2^2*z3*z4 - x2*x3*y1^2 + x2*x3*y1*y2 + ...
              x2*x3*y1*y4 - x2*x3*y2*y4 - x2*x3*z1^2 + x2*x3*z1*z2 + x2*x3*z1*z4 - x2*x3*z2*z4 - x2*x4*y1^2 + x2*x4*y1*y2 + ...
              x2*x4*y1*y3 - x2*x4*y2*y3 - x2*x4*z1^2 + x2*x4*z1*z2 + x2*x4*z1*z3 - x2*x4*z2*z3 + x3*x4*y1^2 - ...
              2*x3*x4*y1*y2 + x3*x4*y2^2 + x3*x4*z1^2 - 2*x3*x4*z1*z2 + x3*x4*z2^2 + y1^2*z2^2 - y1^2*z2*z3 - y1^2*z2*z4 + ...
              y1^2*z3*z4 - 2*y1*y2*z1*z2 + y1*y2*z1*z3 + y1*y2*z1*z4 + y1*y2*z2*z3 + y1*y2*z2*z4 - 2*y1*y2*z3*z4 + ...
              y1*y3*z1*z2 - y1*y3*z1*z4 - y1*y3*z2^2 + y1*y3*z2*z4 + y1*y4*z1*z2 - y1*y4*z1*z3 - y1*y4*z2^2 + y1*y4*z2*z3 + ...
              y2^2*z1^2 - y2^2*z1*z3 - y2^2*z1*z4 + y2^2*z3*z4 - y2*y3*z1^2 + y2*y3*z1*z2 + y2*y3*z1*z4 - y2*y3*z2*z4 - ...
              y2*y4*z1^2 + y2*y4*z1*z2 + y2*y4*z1*z3 - y2*y4*z2*z3 + y3*y4*z1^2 - 2*y3*y4*z1*z2 + y3*y4*z2^2;

    C44_num = -x1^2*y2^2 + 2*x1^2*y2*y3 - x1^2*y3^2 - x1^2*z2^2 + 2*x1^2*z2*z3 - x1^2*z3^2 + 2*x1*x2*y1*y2 - 2*x1*x2*y1*y3 - ...
               2*x1*x2*y2*y3 + 2*x1*x2*y3^2 + 2*x1*x2*z1*z2 - 2*x1*x2*z1*z3 - 2*x1*x2*z2*z3 + 2*x1*x2*z3^2 - 2*x1*x3*y1*y2 + ...
               2*x1*x3*y1*y3 + 2*x1*x3*y2^2 - 2*x1*x3*y2*y3 - 2*x1*x3*z1*z2 + 2*x1*x3*z1*z3 + 2*x1*x3*z2^2 - 2*x1*x3*z2*z3 - ...
               x2^2*y1^2 + 2*x2^2*y1*y3 - x2^2*y3^2 - x2^2*z1^2 + 2*x2^2*z1*z3 - x2^2*z3^2 + 2*x2*x3*y1^2 - 2*x2*x3*y1*y2 - ...
               2*x2*x3*y1*y3 + 2*x2*x3*y2*y3 + 2*x2*x3*z1^2 - 2*x2*x3*z1*z2 - 2*x2*x3*z1*z3 + 2*x2*x3*z2*z3 - x3^2*y1^2 + ...
               2*x3^2*y1*y2 - x3^2*y2^2 - x3^2*z1^2 + 2*x3^2*z1*z2 - x3^2*z2^2 - y1^2*z2^2 + 2*y1^2*z2*z3 - y1^2*z3^2 + ...
               2*y1*y2*z1*z2 - 2*y1*y2*z1*z3 - 2*y1*y2*z2*z3 + 2*y1*y2*z3^2 - 2*y1*y3*z1*z2 + 2*y1*y3*z1*z3 + 2*y1*y3*z2^2 - ...
               2*y1*y3*z2*z3 - y2^2*z1^2 + 2*y2^2*z1*z3 - y2^2*z3^2 + 2*y2*y3*z1^2 - 2*y2*y3*z1*z2 - 2*y2*y3*z1*z3 + ...
               2*y2*y3*z2*z3 - y3^2*z1^2 + 2*y3^2*z1*z2 - y3^2*z2^2;

    C11 = C11_num/C_denom;
    C12 = C12_num/C_denom;
    C13 = C13_num/C_denom;
    C14 = C14_num/C_denom;

    C21 = C12;
    C22 = C22_num/C_denom;
    C23 = C23_num/C_denom;
    C24 = C24_num/C_denom;

    C31 = C13;
    C32 = C23;
    C33 = C33_num/C_denom;
    C34 = C34_num/C_denom;

    C41 = C14;
    C42 = C24;
    C43 = C34;
    C44 = C44_num/C_denom;

end

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%